# Prepare KVM Role - Default Variables
---
# CloudStack version
cloudstack_version: ""

# Hostname configuration
cloudstack_hostname: "{{ ansible_fqdn }}"

# CloudStack repository URLs
cloudstack_repo_base_url_ubuntu: "https://download.cloudstack.org/ubuntu"
cloudstack_repo_base_url_debian: "https://download.cloudstack.org/debian"
cloudstack_repo_gpg_key: "https://download.cloudstack.org/release.asc"

# Service management
cloudstack_enable_services: true
cloudstack_start_services: true

# Libvirt configuration
libvirt_listen_tls: 0
libvirt_listen_tcp: 0
libvirt_tls_port: "16514"
libvirt_tcp_port: "16509"
libvirt_auth_tcp: "none"
libvirt_mdns_adv: 0

# Guest CPU configuration
# Options: custom, host-model, host-passthrough
cloudstack_guest_cpu_mode: "host-passthrough"
cloudstack_guest_cpu_model: "" # Used with custom mode
cloudstack_guest_cpu_features: "" # e.g., "vmx avx -mmx"

# Network bridge configuration
cloudstack_network_mode: "advanced" # Options: basic, advanced

# Management bridge (cloudbr0)
cloudstack_mgmt_bridge: "cloudbr0"
cloudstack_mgmt_interface: "eth0"
cloudstack_mgmt_ip: "{{ ansible_default_ipv4.address | default('') }}"
cloudstack_mgmt_netmask: "{{ ansible_default_ipv4.netmask | default('255.255.255.0') }}"
cloudstack_mgmt_prefix: "24"
cloudstack_mgmt_gateway: "{{ ansible_default_ipv4.gateway | default('') }}"
cloudstack_mgmt_dns: ["8.8.8.8", "8.8.4.4"]
cloudstack_mgmt_domain: "{{ ansible_domain | default('local') }}"

# Guest bridge configuration
cloudstack_guest_bridge: "cloudbr0"
cloudstack_guest_interface: "eth0"
cloudstack_guest_vlan: ""

# Bridge STP settings
cloudstack_bridge_stp: "off"
cloudstack_bridge_fd: 5
cloudstack_bridge_maxwait: 1

# Use netplan (Ubuntu 20.04+)
cloudstack_use_netplan: true

# Firewall configuration
cloudstack_configure_firewall: true
cloudstack_firewall_ports:
  - { port: 22, proto: tcp }
  - { port: 1798, proto: tcp }
  - { port: 16514, proto: tcp }
  - { port: "5900:6100", proto: tcp }
  - { port: "49152:49216", proto: tcp }

# AppArmor configuration
cloudstack_disable_apparmor_libvirt: true

# Non-root user for adding host (optional)
cloudstack_host_user: ""

# SSH configuration for CloudStack management access
cloudstack_enable_pass_auth: true
cloudstack_root_password: ""
cloudstack_ssh_user: ""
cloudstack_mgmt_ssh_public_key: ""

# Local storage configuration
cloudstack_local_storage_enabled: true
cloudstack_local_storage_path: "/var/lib/libvirt/images"
cloudstack_local_storage_owner: "root"
cloudstack_local_storage_group: "root"
cloudstack_local_storage_mode: "0755"

# UEFI support
cloudstack_uefi_support: false

# Secondary storage bypass support (aria2)
cloudstack_aria2_support: false

# VFIO GPU Passthrough configuration
cloudstack_vfio_gpu_enabled: false
cloudstack_vfio_reboot: true
